package com.chinaops.web.agent.dao;

import java.util.List;

import com.chinaops.web.agent.base.GenericHibernateDao;
import com.chinaops.web.agent.entity.Agent;
import com.chinaops.web.agent.entity.Page;

/**
 * Description: agent持久层
 * Copyright (c) Department of Research and Development/Beijing/china-ops.
 * All Rights Reserved.
 * @version 1.0  2013-8-20 上午10:05:45 崔万哲 (cuiwanzhe@china-ops.com) 创建
 */
public class AgentDaoImpl extends GenericHibernateDao<Agent>{
	
	/**
	 * Description: 获取所有agent
	 * @Version 1.0 2013-8-20 上午10:05:57崔万哲(cuiwanzhe@china-ops.com) 创建
	 * @return
	 */
	public List<Agent> getAllAgents(){
		return this.find("from Agent order by id desc");
	}
	
	/**
	 * Description: 根据操作系统类型和位数来查询agent
	 * @Version 1.0 2013-8-20 上午10:06:13崔万哲(cuiwanzhe@china-ops.com) 创建
	 * @param ostype
	 * @param arch
	 * @return
	 */
	public List<Agent> getAgentsByOstypeArch(String ostype, String arch){
		return this.find("from Agent where ostype=? and arch=?",new Object[]{ostype,arch});	
	}
	
	/**
	 * Description: 分页查询
	 * @Version 1.0 2013-8-20 上午10:06:13崔万哲(cuiwanzhe@china-ops.com) 创建
	 * @param ostype
	 * @param arch
	 * @return
	 */
	public Page getAgentsByPage(String ostype, String arch,String status,int pageNo,int pageSize){
		String sql_where = "";
		if(ostype.equals("0")&&!arch.equals("0")&&!status.equals("00")){
			sql_where = "from Agent where arch='" + arch + "' and status='" + status + "' order by id desc";
		}else if(arch.equals("0")&&!ostype.equals("0")&&!status.equals("00")){
			sql_where = "from Agent where ostype='" + ostype + "' and status='" +status+ "' order by id desc";
		}else if(status.equals("00")&&!ostype.equals("0")&&!arch.equals("0")){
			sql_where = "from Agent where ostype='" + ostype + "' and arch='" + arch + "' order by id desc";
		}else if(ostype.equals("0")&&arch.equals("0")&&status.equals("00")){
			sql_where = "from Agent order by id desc";
		}else if(!ostype.equals("0")&&arch.equals("0")&&status.equals("00")){
			sql_where = "from Agent where ostype='" + ostype + "' order by id desc";
		}else if(ostype.equals("0")&&!arch.equals("0")&&status.equals("00")){
			sql_where = "from Agent where arch='" + arch + "' order by id desc";
		}else if(ostype.equals("0")&&arch.equals("0")&&!status.equals("00")){
			sql_where = "from Agent where status='" +status+ "' order by id desc";
		}else{
			sql_where = "from Agent where ostype='" + ostype + "' and arch='" + arch + "' and status='"+status+"' order by id desc";
		}
		return super.findByPage(sql_where,pageNo, pageSize);
		
	}
	
	/**
	 * Description: 根据id删除
	 * @Version 1.0 2013-8-20 上午10:19:32崔万哲(cuiwanzhe@china-ops.com) 创建
	 * @param id
	 */
	public void deleteAgent(Integer id){
		this.executeUpdate("delete from Agent where id=?", id);
	}
	
}
